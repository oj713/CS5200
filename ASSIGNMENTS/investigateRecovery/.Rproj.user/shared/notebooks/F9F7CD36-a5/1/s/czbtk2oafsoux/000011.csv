"0","#' Creates a playlist with desired tracks"
"0","#' Assumption: The new playlist name is unique. "
"0","#' "
"0","#' @param dbcon the database"
"0","#' @param playlist_name the name of the new playlist"
"0","#' @param tracks vector of trackIDs for any tracks to add to the playlist"
"0","#' @return status -- TRUE if success, FALSE otherwise"
"0","createPlaylist <- function (dbcon, playlist_name, tracks) {"
"0","  "
"0","  dbExecute(dbcon, ""BEGIN TRANSACTION"")"
"0","  "
"0","  tryCatch({"
"0","    # create new playlist"
"0","    sql <- paste0(""INSERT INTO playlists(Name) VALUES ('"", "
"0","                  playlist_name, ""');"")"
"0","    dbSendStatement(dbcon, sql) |>"
"0","      dbClearResult()"
"0","    "
"0","    # retrieve playlistId for new item"
"0","    pid <- dbGetQuery(dbcon,"
"0","                 paste0(""SELECT PlaylistId FROM playlists "","
"0","                         ""WHERE Name = '"", playlist_name, ""'""))[[1, 1]]"
"0","    "
"0","    # insert new rows into playlist_track for any tracks "
"0","    sql <- paste(""INSERT INTO playlist_track(PlaylistID, TrackId) VALUES"","
"0","                 paste(""("", pid, "","", tracks, "")"", collapse = "",""))"
"0","    dbSendStatement(dbcon, sql) |>"
"0","      dbClearResult()"
"0","    "
"0","    dbExecute(dbcon, ""COMMIT TRANSACTION"")"
"0","    "
"0","    return(TRUE)"
"0","    "
"0","  }, error = function(e) {"
"0","    "
"0","    # rolling back if anything breaks"
"0","    dbExecute(dbcon, ""ROLLBACK TRANSACTION"")"
"0","    return(FALSE)"
"0","  })"
"0","}"
